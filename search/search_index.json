{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Documentation SC942C","text":"<p>Bienvenue sur la documentation du module SC942C.</p> <p>Ce projet s'inscrit dans la d\u00e9marche Open Source Hardware du projet Essensys Atrium.</p>"},{"location":"#apercu-du-schema","title":"Aper\u00e7u du sch\u00e9ma","text":"<p>Voici un aper\u00e7u de l'architecture \u00e9lectronique du module (Extraits).</p>"},{"location":"#microcontroleur-mcu","title":"Microcontr\u00f4leur (MCU)","text":""},{"location":"#connecteurs","title":"Connecteurs","text":""},{"location":"#contenu","title":"Contenu","text":"<ul> <li>\ud83c\udfdb\ufe0f Architecture : Vue d'ensemble du fonctionnement.</li> <li>\ud83d\udd0c Hardware : D\u00e9tails techniques et composants.</li> <li>\u2699\ufe0f Firmware : Documentation du code embarqu\u00e9.</li> <li>\ud83d\udcbe T\u00e9l\u00e9chargements : Fichiers sources (Gerbers, STEP, PDF).</li> </ul>"},{"location":"architecture/","title":"\ud83c\udfdb\ufe0f Architecture","text":""},{"location":"architecture/#synoptique","title":"Synoptique","text":"<p>Le module SC942C est une carte d'entr\u00e9es/sorties pilot\u00e9e par un bus I2C. Il agit comme un esclave sur le bus.</p> <pre><code>graph LR\n    Master[\"Ma\u00eetre (Atrium)\"] -- I2C (SDA/SCL) --&gt; Slave[\"SC942C (Esclave)\"]\n    Slave -- Pilotage --&gt; Relais[\"Relais / Variateurs\"]\n    Slave -- Lecture --&gt; Entrees[\"Boutons Poussoirs\"]</code></pre>"},{"location":"architecture/#protocole-de-communication-i2c","title":"Protocole de Communication (I2C)","text":"<ul> <li>Adresse I2C par d\u00e9faut : <code>0x11</code> (7-bit)</li> <li>Vitesse : Standard (100kHz) ou Fast (400kHz)</li> <li>R\u00f4le : Esclave</li> </ul>"},{"location":"architecture/#structure-des-echanges","title":"Structure des \u00c9changes","text":"<p>Le protocole fonctionne sur un m\u00e9canisme de Commandes (\u00c9criture) et de Status (Lecture).</p> <ol> <li>Le Ma\u00eetre \u00e9crit une trame commen\u00e7ant par un <code>Code Commande</code> suivi des param\u00e8tres.</li> <li>Le Ma\u00eetre lit (optionnel) pour v\u00e9rifier l'\u00e9tat du dernier \u00e9change (ACK/NACK logique, erreurs).</li> </ol>"},{"location":"architecture/#tables-de-reference-maitre-esclave","title":"Tables de R\u00e9f\u00e9rence (Ma\u00eetre -&gt; Esclave)","text":"<p>Voici la liste des commandes disponibles pour piloter le module.</p>"},{"location":"architecture/#1-forcage-des-sorties-0x01","title":"1. For\u00e7age des Sorties (<code>0x01</code>)","text":"<p>Commande utilis\u00e9e pour piloter directement les relais, variateurs et volets.</p> Octet Fonction Description 0 Code <code>0x01</code> 1 Relais OFF (LSB) Masque d'extinction des relais 0-7 2 Relais ON (LSB) Masque d'allumage des relais 0-7 3 Relais OFF (MSB) Masque d'extinction des relais 8-15 4 Relais ON (MSB) Masque d'allumage des relais 8-15 5 Variateurs OFF Masque d'extinction des variateurs 6 Variateurs ON Masque d'allumage des variateurs 7 Volets (Sens 1) Commande Mont\u00e9e/Ouvrir 8 Volets (Sens 2) Commande Descente/Fermer"},{"location":"architecture/#2-configuration-des-sorties-0x02","title":"2. Configuration des Sorties (<code>0x02</code>)","text":"<p>D\u00e9finit le mode de fonctionnement des variateurs (TOR ou Gradation).</p> Octet Fonction Description 0 Code <code>0x02</code> 1 Config Var 0 <code>0</code>=TOR, <code>1</code>=Variateur, etc. 2 Config Var 1 ... n Config Var n ..."},{"location":"architecture/#3-temps-dextinction-0x03","title":"3. Temps d'Extinction (<code>0x03</code>)","text":"<p>Configure la minuterie pour l'extinction automatique des relais.</p> Octet Fonction Description 0 Code <code>0x03</code> 1 Temps Relais 0 En minutes (0 = pas de minuterie) ... ... ..."},{"location":"architecture/#4-temps-daction-volets-0x04","title":"4. Temps d'Action Volets (<code>0x04</code>)","text":"<p>Configure la dur\u00e9e d'activation des relais pour les volets.</p> Octet Fonction Description 0 Code <code>0x04</code> 1 Temps Volet 0 En secondes ... ... ..."},{"location":"architecture/#5-actions-globales-0x05","title":"5. Actions Globales (<code>0x05</code>)","text":"<p>Commandes sp\u00e9ciales (Sauvegarde, Reset, etc.).</p> Octet Fonction Description 0 Code <code>0x05</code> 1 Action Bit 0: Sauvegarde EEPROM"},{"location":"architecture/#retour-detat-esclave-maitre","title":"Retour d'\u00c9tat (Esclave -&gt; Ma\u00eetre)","text":"<p>Lors d'une lecture, l'esclave renvoie une structure de status (<code>TxBuf</code>).</p> Bit Nom Description Byte 0 LastCode Code de la derni\u00e8re trame re\u00e7ue Byte 1 Flags \u00c9tat du module ... Bit 0 <code>chkfail</code> Erreur de Checksum ... Bit 1 <code>rxerror</code> Erreur de r\u00e9ception g\u00e9n\u00e9rique ... Bit 2 <code>ovflw</code> Overflow Buffer ... Bit 3 <code>sspov</code> Overflow Hardware (SSP) ... Bit 4 <code>noactivity</code> Pas d'activit\u00e9 I2C d\u00e9tect\u00e9e (Watchdog Com)"},{"location":"downloads/","title":"\ud83d\udcbe T\u00e9l\u00e9chargements","text":"<p>Retrouvez ici tous les fichiers de conception et de fabrication pour le module SC942C.</p> Ressource Description Lien \ud83d\udcc2 Sch\u00e9ma PDF Sch\u00e9matique complet du module T\u00e9l\u00e9charger (PDF) \ud83d\udce6 Mod\u00e8le 3D Mod\u00e8le STEP pour l'int\u00e9gration m\u00e9canique T\u00e9l\u00e9charger (STEP) \ud83c\udfed Gerbers Fichiers de fabrication pour PCB T\u00e9l\u00e9charger (ZIP) \ud83d\udcc4 Plan d'assemblage Dessin d'assemblage des composants T\u00e9l\u00e9charger (PDF)"},{"location":"firmware/","title":"\u2699\ufe0f Firmware","text":"<p>Cette page documente le firmware du module d\u00e9cod\u00e9 depuis les sources fournies (<code>Prog/code_ba</code>).</p>"},{"location":"firmware/#environnement-de-developpement","title":"Environnement de D\u00e9veloppement","text":"<ul> <li>MCU Cible : Famille Microchip PIC18 (Probablement PIC18Fxx vu les registres <code>TRISF</code>, <code>TRISE</code> etc.)</li> <li>Langage : C (MPLAB C18 / XC8)</li> <li>Architecture : Boucle principale sans OS + Interruptions</li> </ul>"},{"location":"firmware/#structure-du-projet","title":"Structure du Projet","text":"<p>Les fichiers sources sont organis\u00e9s comme suit :</p> Fichier Description <code>main.c</code> Point d'entr\u00e9e, boucle infinie, gestion du Watchdog. <code>hard.h</code> / <code>hard.c</code> Abstraction mat\u00e9rielle (HAL). D\u00e9finition des broches (<code>#define</code>). <code>gestionentrees.c</code> Logique de filtrage, anti-rebond et d\u00e9tection (Simple/Double Clic, Appui Long). <code>slavenode.c</code> Gestion du protocole de communication I2C (Esclave) et commandes."},{"location":"firmware/#mapping-memoire-eeprom","title":"Mapping M\u00e9moire (EEPROM)","text":"<p>L'EEPROM est utilis\u00e9e pour stocker la configuration et l'\u00e9tat de sauvegarde.</p> Adresse Variable Stock\u00e9e Description <code>0x0010</code> <code>us_SortiesRelais</code> \u00c9tat sauvegard\u00e9 des relais simples (LSB/MSB). <code>0x0014</code> Config Variateurs Mode des variateurs (3 octets par variateur). <code>0x002A</code> <code>uc_TempsCdeVolet</code> Temps d'activation pour les volets. <code>0x0032</code> <code>uc_TempsCdeLampe</code> Temporisation pour l'extinction automatique. <code>0x0042</code> Compteur Compteur d'\u00e9criture EEPROM (Diagnostic)."},{"location":"firmware/#mapping-logique-vs-physique","title":"Mapping Logique vs Physique","text":"<p>Bas\u00e9 sur <code>hard.h</code> (Configuration <code>TYPE_PIECES_DE_VIE_PROTO</code>), voici la correspondance entre les entr\u00e9es logiques et les ports du microcontr\u00f4leur.</p> Index Logique Variable Port MCU Pin Physique (Est.) 0 <code>ENTREE0</code> <code>PORTB&lt;0&gt;</code> RB0 1 <code>ENTREE1</code> <code>PORTF&lt;3&gt;</code> RF3 2 <code>ENTREE2</code> <code>PORTF&lt;2&gt;</code> RF2 3 <code>ENTREE3</code> <code>PORTF&lt;1&gt;</code> RF1 4 <code>ENTREE4</code> <code>PORTF&lt;0&gt;</code> RF0 5 <code>ENTREE5</code> <code>PORTG&lt;5&gt;</code> RG5 6 <code>ENTREE6</code> <code>PORTG&lt;4&gt;</code> RG4 7 <code>ENTREE7</code> <code>PORTG&lt;3&gt;</code> RG3 8 <code>ENTREE8</code> <code>PORTG&lt;2&gt;</code> RG2 9 <code>ENTREE9</code> <code>PORTG&lt;1&gt;</code> RG1 10 <code>ENTREE10</code> <code>PORTG&lt;0&gt;</code> RG0 11 <code>ENTREE11</code> <code>PORTD&lt;7&gt;</code> RD7 <p>(Extrait partiel, voir <code>hard.h</code> pour la liste compl\u00e8te)</p>"},{"location":"firmware/#logique-fonctionnelle","title":"Logique Fonctionnelle","text":""},{"location":"firmware/#boucle-principale","title":"Boucle Principale","text":"<pre><code>graph TD\n    Start((D\u00e9marrage)) --&gt; Init[Initialisation Variables &amp; Hard]\n    Init --&gt; I2CSetup[Setup I2C]\n    I2CSetup --&gt; Loop{Boucle Infinie}\n    Loop --&gt; |40ms| Cycle[Traitement Cycle]\n    Cycle --&gt; Inputs[Analyse Entr\u00e9es]\n    Inputs --&gt; App[Traitement Applicatif]\n    App --&gt; I2C[Traitement I2C]\n    I2C --&gt; Outputs[Pilotage Sorties]\n    Outputs --&gt; Loop\n\n    subgraph Interruptions\n    IT[Interruption Timer/I2C] --&gt; TimerHandle[Gestion Timer &amp; PWM]\n    IT --&gt; I2CHandle[Gestion I2C Slave]\n    end</code></pre>"},{"location":"firmware/#traitement-des-entrees","title":"Traitement des Entr\u00e9es","text":"<p>Le fichier <code>gestionentrees.c</code> impl\u00e9mente une machine \u00e0 \u00e9tats sophistiqu\u00e9e pour g\u00e9rer les boutons poussoirs.</p> <pre><code>graph LR\n    Raw[\"Entr\u00e9e Brute (ISR)\"] --&gt; Debounce[\"Anti-Rebond\"]\n    Debounce --&gt; Filter[\"Filtrage (EtatFiltre)\"]\n    Filter --&gt; Logic{Analyse}\n    Logic --&gt;|Clic &lt; T_Double| Double[\"Double Clic\"]\n    Logic --&gt;|Maintenu &gt; T_Long| Long[\"Appui Long\"]\n    Logic --&gt;|Rel\u00e2ch\u00e9| Simple[\"Appui Court\"]\n\n    Simple --&gt; Action[\"Commande Actionneur\"]\n    Double --&gt; Action\n    Long --&gt; Action</code></pre>"},{"location":"hardware/","title":"\ud83d\udd0c Hardware","text":""},{"location":"hardware/#specifications-techniques","title":"Sp\u00e9cifications Techniques","text":"<ul> <li>Microcontr\u00f4leur : Microchip PIC16F946-I/PT (8-bit)</li> <li>Alimentation : R\u00e9gulateur Step-Down LMR12010YMK (3V-20V vers basse tension)</li> <li>Horloge : Quartz 20 MHz</li> </ul>"},{"location":"hardware/#interfaces-controlees","title":"Interfaces Contr\u00f4l\u00e9es","text":"<p>Le module pilote une s\u00e9rie de relais et de variateurs.</p>"},{"location":"hardware/#sorties-relais","title":"Sorties (Relais)","text":"Type Designator Description Quantit\u00e9 Relais Simple K1, K2, K3, K8, K9, K12, K15 Finder 34.51 (1RT, 6A) sur support 93.11 7 Relais Bistable K4-K7, K10-K11, K13-K14, K16-K17 Finder 40.61.6 (1RT, 16A) sur support 95.15.2 10"},{"location":"hardware/#variateurs","title":"Variateurs","text":"Composant Designator Description Quantit\u00e9 Module Gradateur U2, U3, U6, U8 Carte fille SC943-0C 4"},{"location":"hardware/#liste-des-composants-bom","title":"Liste des Composants (BOM)","text":"<p>Voici la liste exhaustive des composants \u00e9lectroniques du module.</p> D\u00e9signation Valeur / R\u00e9f Qt\u00e9 Microcontr\u00f4leur PIC16F946-I/PT 1 R\u00e9gulateur Texas Instruments LMR12010YMK 1 Superviseur NCP803SN308T1G (Reset 3.08V) 1 Driver MOSFET MIC4426YM (Dual 1.5A) 1 Transistors ZXMN3A01F (MOSFET N 30V 2A) 28 Quartz Citizen Finedevice HCM49 20.000MABJ-UT 1 Relais Simples Finder 34.51 (12Vdc) 7 Relais Bistables Finder 40.61.6 (12Vdc) 10 Cartes Filles Variateur SC943-0C 4 Diodes - Transil/TVS SMF5V0A-GS08 (5V 200W) 23 - Schottky BAT54C (Double) 18 - Schottky PMEG2020AEA (2A 20V) 1 - Redressement GF1B (1A 100V) 1 Connecteurs - Borniers (Ressort) Phoenix Contact FFKDSA1/V2 (7.62mm) 29 - Borniers (Ressort) Phoenix Contact FFKDS/V2 (5.08mm) 18 Passifs - Condensateurs 100nF, 10uF, 10nF, 18pF, 220pF ~40 - R\u00e9sistances 10k, 22k, 6.8k, 1k, etc. ~80 - Selfs 10uH, Ferrites 3 - Varistances VDR (275Vac) 4 <p>Note : Cette liste est une synth\u00e8se. Se r\u00e9f\u00e9rer au fichier Excel/CSV complet pour les r\u00e9f\u00e9rences pr\u00e9cises lors de la fabrication.</p>"}]}